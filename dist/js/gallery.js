'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.updatePhotos = undefined;

var _photo = require('./photo.js');

var photo = _interopRequireWildcard(_photo);

var _form = require('./form.js');

var form = _interopRequireWildcard(_form);

var _backend = require('./backend.js');

var backend = _interopRequireWildcard(_backend);

var _filter = require('./filter.js');

var filter = _interopRequireWildcard(_filter);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

// DOM-элемент, в котором размещаются фотографии пользователей
var container = document.querySelector('.pictures');

// Форма загрузки изображения
var uploadForm = document.querySelector('.img-upload__form');

// Кнопка загрузки изображения
var uploadButton = uploadForm.querySelector('#upload-file');

// Поп-ап для вывода возможной ошибки при загрузке и его элементы
var errorPopup = document.querySelector('.error-popup');
var errorPopupClose = errorPopup.querySelector('.error-popup__cancel');
var errorPopupMessage = errorPopup.querySelector('.error-popup__message');

var POPAP_ERROR_INTERVAL = 5000;
var COMMENT_LENGTH_MAX = 140;

var photos = [];
var photoElements = [];

/**
 * Отображает DOM-элементы `Фотография`, созданный на основе массива объектов photoData,
 * на странице
 *
 * @param {Array.<Object>} photoDataArray
 */
var renderPhotos = function renderPhotos(photoDataArray) {
  var fragment = document.createDocumentFragment();
  photoElements = photoDataArray.map(function (value) {
    return photo.create(value);
  });
  photoElements.forEach(function (value) {
    return fragment.appendChild(value);
  });

  container.appendChild(fragment);
};

/**
 * Удаляет DOM-элементы `Фотография` photoElements
 *
 */
var removePhotos = function removePhotos() {
  photoElements.forEach(function (it) {
    return container.removeChild(it);
  });
};

/**
* Обновляет DOM-элементы `Фотография` после фильтрации
*
* @param {Array.<Object>} photoDataArray
*/
var updatePhotos = exports.updatePhotos = function updatePhotos(photoDataArray) {
  removePhotos();
  renderPhotos(photoDataArray);
};

/**
 * Для корректного отображения разбивает слишком длинные комментарии,
 * предоставленные сервером, на комментарии длины не более COMMENT_LENGTH_MAX
 * и возвращает новый объект photoData
 *
 * @param {Object} photoData Объект до форматирования
 * @return {Object} Объект после форматирования
 */
var formatData = function formatData(photoData) {
  var comments = photoData.comments.reduce(function (acc, comment) {
    return comment.length > COMMENT_LENGTH_MAX ? [].concat(_toConsumableArray(acc), _toConsumableArray(comment.split('. '))) : [].concat(_toConsumableArray(acc), [comment]);
  }, []);

  var url = photoData.url,
      likes = photoData.likes,
      description = photoData.description;


  return { url: url, likes: likes, comments: comments, description: description };
};

/**
 * Форматирует полученные данные и отображает их,
 * инициализирует работу фильтрации
 *
 * @param {Array.<Object>} data Загруженные с сервера данные
 */
var onSuccess = function onSuccess(data) {
  photos = data.map(function (it) {
    return formatData(it);
  });
  renderPhotos(photos);
  filter.initialize(photos);
};

/**
 * Закрывает поп-ап с сообщением об ошибке
 *
 */
var onErrorPopupCloseClick = function onErrorPopupCloseClick() {
  errorPopup.classList.add('hidden');
  errorPopupClose.removeEventListener('click', onErrorPopupCloseClick);
};

/**
 * Показывает поп-ап с сообщением об ошибке
 *
 * @param {string} message
 */
var onError = function onError(message) {
  if (errorPopup.classList.contains('hidden')) {
    errorPopup.classList.remove('hidden');
    errorPopupMessage.textContent = message;
    setTimeout(onErrorPopupCloseClick, POPAP_ERROR_INTERVAL);
    errorPopupClose.addEventListener('click', onErrorPopupCloseClick);
  }
};

/**
 * Инициализирует работу со страницей сайта
 *
 */
var initialize = function initialize() {
  // Загружает с сервера фотографии и отображает их.
  // В случае ошибки загрузки данных показывает поп-ап с описанием ошибки
  backend.load(onSuccess, onError);

  // Открывает панель редактирования фотографии при
  // нажатии на кнопку uploadButton
  uploadButton.addEventListener('change', form.initialize);
};

initialize();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2pzL2dhbGxlcnkuanMiXSwibmFtZXMiOlsicGhvdG8iLCJmb3JtIiwiYmFja2VuZCIsImZpbHRlciIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInVwbG9hZEZvcm0iLCJ1cGxvYWRCdXR0b24iLCJlcnJvclBvcHVwIiwiZXJyb3JQb3B1cENsb3NlIiwiZXJyb3JQb3B1cE1lc3NhZ2UiLCJQT1BBUF9FUlJPUl9JTlRFUlZBTCIsIkNPTU1FTlRfTEVOR1RIX01BWCIsInBob3RvcyIsInBob3RvRWxlbWVudHMiLCJyZW5kZXJQaG90b3MiLCJwaG90b0RhdGFBcnJheSIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIm1hcCIsInZhbHVlIiwiY3JlYXRlIiwiZm9yRWFjaCIsImFwcGVuZENoaWxkIiwicmVtb3ZlUGhvdG9zIiwiaXQiLCJyZW1vdmVDaGlsZCIsInVwZGF0ZVBob3RvcyIsImZvcm1hdERhdGEiLCJwaG90b0RhdGEiLCJjb21tZW50cyIsInJlZHVjZSIsImFjYyIsImNvbW1lbnQiLCJsZW5ndGgiLCJzcGxpdCIsInVybCIsImxpa2VzIiwiZGVzY3JpcHRpb24iLCJvblN1Y2Nlc3MiLCJkYXRhIiwiaW5pdGlhbGl6ZSIsIm9uRXJyb3JQb3B1cENsb3NlQ2xpY2siLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwib25FcnJvciIsIm1lc3NhZ2UiLCJjb250YWlucyIsInJlbW92ZSIsInRleHRDb250ZW50Iiwic2V0VGltZW91dCIsImFkZEV2ZW50TGlzdGVuZXIiLCJsb2FkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0lBQVlBLEs7O0FBQ1o7O0lBQVlDLEk7O0FBQ1o7O0lBQVlDLE87O0FBQ1o7O0lBQVlDLE07Ozs7OztBQUVaO0FBQ0EsSUFBTUMsWUFBWUMsU0FBU0MsYUFBVCxhQUFsQjs7QUFFQTtBQUNBLElBQU1DLGFBQWFGLFNBQVNDLGFBQVQscUJBQW5C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LGdCQUFoQixVQUEwQ1Ysc0JBQTFDO0FBQ0Q7QUFDRixDQVBEOztBQVNBOzs7O0FBSUEsSUFBTUQsYUFBYSxTQUFiQSxVQUFhLEdBQU07QUFDdkI7QUFDQTtBQUNBeEMsVUFBUW9ELElBQVIsQ0FBYWQsU0FBYixFQUF3Qk8sT0FBeEI7O0FBRUE7QUFDQTtBQUNBdkMsZUFBYTZDLGdCQUFiLFdBQXdDcEQsS0FBS3lDLFVBQTdDO0FBQ0QsQ0FSRDs7QUFVQUEiLCJmaWxlIjoiZ2FsbGVyeS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBob3RvIGZyb20gJy4vcGhvdG8uanMnO1xuaW1wb3J0ICogYXMgZm9ybSBmcm9tICcuL2Zvcm0uanMnO1xuaW1wb3J0ICogYXMgYmFja2VuZCBmcm9tICcuL2JhY2tlbmQuanMnO1xuaW1wb3J0ICogYXMgZmlsdGVyIGZyb20gJy4vZmlsdGVyLmpzJztcblxuLy8gRE9NLdGN0LvQtdC80LXQvdGCLCDQsiDQutC+0YLQvtGA0L7QvCDRgNCw0LfQvNC10YnQsNGO0YLRgdGPINGE0L7RgtC+0LPRgNCw0YTQuNC4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC5XG5jb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAucGljdHVyZXNgKTtcblxuLy8g0KTQvtGA0LzQsCDQt9Cw0LPRgNGD0LfQutC4INC40LfQvtCx0YDQsNC20LXQvdC40Y9cbmNvbnN0IHVwbG9hZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaW1nLXVwbG9hZF9fZm9ybWApO1xuXG4vLyDQmtC90L7Qv9C60LAg0LfQsNCz0YDRg9C30LrQuCDQuNC30L7QsdGA0LDQttC10L3QuNGPXG5jb25zdCB1cGxvYWRCdXR0b24gPSB1cGxvYWRGb3JtLnF1ZXJ5U2VsZWN0b3IoYCN1cGxvYWQtZmlsZWApO1xuXG4vLyDQn9C+0L8t0LDQvyDQtNC70Y8g0LLRi9Cy0L7QtNCwINCy0L7Qt9C80L7QttC90L7QuSDQvtGI0LjQsdC60Lgg0L/RgNC4INC30LDQs9GA0YPQt9C60LUg0Lgg0LXQs9C+INGN0LvQtdC80LXQvdGC0YtcbmNvbnN0IGVycm9yUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZXJyb3ItcG9wdXBgKTtcbmNvbnN0IGVycm9yUG9wdXBDbG9zZSA9IGVycm9yUG9wdXAucXVlcnlTZWxlY3RvcihgLmVycm9yLXBvcHVwX19jYW5jZWxgKTtcbmNvbnN0IGVycm9yUG9wdXBNZXNzYWdlID0gZXJyb3JQb3B1cC5xdWVyeVNlbGVjdG9yKGAuZXJyb3ItcG9wdXBfX21lc3NhZ2VgKTtcblxuY29uc3QgUE9QQVBfRVJST1JfSU5URVJWQUwgPSA1MDAwO1xuY29uc3QgQ09NTUVOVF9MRU5HVEhfTUFYID0gMTQwO1xuXG5sZXQgcGhvdG9zID0gW107XG5sZXQgcGhvdG9FbGVtZW50cyA9IFtdO1xuXG4vKipcbiAqINCe0YLQvtCx0YDQsNC20LDQtdGCIERPTS3RjdC70LXQvNC10L3RgtGLIGDQpNC+0YLQvtCz0YDQsNGE0LjRj2AsINGB0L7Qt9C00LDQvdC90YvQuSDQvdCwINC+0YHQvdC+0LLQtSDQvNCw0YHRgdC40LLQsCDQvtCx0YrQtdC60YLQvtCyIHBob3RvRGF0YSxcbiAqINC90LAg0YHRgtGA0LDQvdC40YbQtVxuICpcbiAqIEBwYXJhbSB7QXJyYXkuPE9iamVjdD59IHBob3RvRGF0YUFycmF5XG4gKi9cbmNvbnN0IHJlbmRlclBob3RvcyA9IChwaG90b0RhdGFBcnJheSkgPT4ge1xuICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgcGhvdG9FbGVtZW50cyA9IHBob3RvRGF0YUFycmF5Lm1hcCgodmFsdWUpID0+IHBob3RvLmNyZWF0ZSh2YWx1ZSkpO1xuICBwaG90b0VsZW1lbnRzLmZvckVhY2goKHZhbHVlKSA9PiBmcmFnbWVudC5hcHBlbmRDaGlsZCh2YWx1ZSkpO1xuXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG59O1xuXG4vKipcbiAqINCj0LTQsNC70Y/QtdGCIERPTS3RjdC70LXQvNC10L3RgtGLIGDQpNC+0YLQvtCz0YDQsNGE0LjRj2AgcGhvdG9FbGVtZW50c1xuICpcbiAqL1xuY29uc3QgcmVtb3ZlUGhvdG9zID0gKCkgPT4ge1xuICBwaG90b0VsZW1lbnRzLmZvckVhY2goKGl0KSA9PiBjb250YWluZXIucmVtb3ZlQ2hpbGQoaXQpKTtcbn07XG5cbmV4cG9ydCAvKipcbiAqINCe0LHQvdC+0LLQu9GP0LXRgiBET00t0Y3Qu9C10LzQtdC90YLRiyBg0KTQvtGC0L7Qs9GA0LDRhNC40Y9gINC/0L7RgdC70LUg0YTQuNC70YzRgtGA0LDRhtC40LhcbiAqXG4gKiBAcGFyYW0ge0FycmF5LjxPYmplY3Q+fSBwaG90b0RhdGFBcnJheVxuICovXG5jb25zdCB1cGRhdGVQaG90b3MgPSAocGhvdG9EYXRhQXJyYXkpID0+IHtcbiAgcmVtb3ZlUGhvdG9zKCk7XG4gIHJlbmRlclBob3RvcyhwaG90b0RhdGFBcnJheSk7XG59O1xuXG4vKipcbiAqINCU0LvRjyDQutC+0YDRgNC10LrRgtC90L7Qs9C+INC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0YDQsNC30LHQuNCy0LDQtdGCINGB0LvQuNGI0LrQvtC8INC00LvQuNC90L3Ri9C1INC60L7QvNC80LXQvdGC0LDRgNC40LgsXG4gKiDQv9GA0LXQtNC+0YHRgtCw0LLQu9C10L3QvdGL0LUg0YHQtdGA0LLQtdGA0L7QvCwg0L3QsCDQutC+0LzQvNC10L3RgtCw0YDQuNC4INC00LvQuNC90Ysg0L3QtSDQsdC+0LvQtdC1IENPTU1FTlRfTEVOR1RIX01BWFxuICog0Lgg0LLQvtC30LLRgNCw0YnQsNC10YIg0L3QvtCy0YvQuSDQvtCx0YrQtdC60YIgcGhvdG9EYXRhXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHBob3RvRGF0YSDQntCx0YrQtdC60YIg0LTQviDRhNC+0YDQvNCw0YLQuNGA0L7QstCw0L3QuNGPXG4gKiBAcmV0dXJuIHtPYmplY3R9INCe0LHRitC10LrRgiDQv9C+0YHQu9C1INGE0L7RgNC80LDRgtC40YDQvtCy0LDQvdC40Y9cbiAqL1xuY29uc3QgZm9ybWF0RGF0YSA9IChwaG90b0RhdGEpID0+IHtcbiAgY29uc3QgY29tbWVudHMgPSBwaG90b0RhdGEuY29tbWVudHMucmVkdWNlKChhY2MsIGNvbW1lbnQpID0+XG4gICAgKGNvbW1lbnQubGVuZ3RoID4gQ09NTUVOVF9MRU5HVEhfTUFYID9cbiAgICAgIFsuLi5hY2MsIC4uLmNvbW1lbnQuc3BsaXQoYC4gYCldIDpcbiAgICAgIFsuLi5hY2MsIGNvbW1lbnRdKSxcbiAgW10pO1xuXG4gIGNvbnN0IHt1cmwsIGxpa2VzLCBkZXNjcmlwdGlvbn0gPSBwaG90b0RhdGE7XG5cbiAgcmV0dXJuICh7dXJsLCBsaWtlcywgY29tbWVudHMsIGRlc2NyaXB0aW9ufSk7XG59O1xuXG4vKipcbiAqINCk0L7RgNC80LDRgtC40YDRg9C10YIg0L/QvtC70YPRh9C10L3QvdGL0LUg0LTQsNC90L3Ri9C1INC4INC+0YLQvtCx0YDQsNC20LDQtdGCINC40YUsXG4gKiDQuNC90LjRhtC40LDQu9C40LfQuNGA0YPQtdGCINGA0LDQsdC+0YLRgyDRhNC40LvRjNGC0YDQsNGG0LjQuFxuICpcbiAqIEBwYXJhbSB7QXJyYXkuPE9iamVjdD59IGRhdGEg0JfQsNCz0YDRg9C20LXQvdC90YvQtSDRgSDRgdC10YDQstC10YDQsCDQtNCw0L3QvdGL0LVcbiAqL1xuY29uc3Qgb25TdWNjZXNzID0gKGRhdGEpID0+IHtcbiAgcGhvdG9zID0gZGF0YS5tYXAoKGl0KSA9PiBmb3JtYXREYXRhKGl0KSk7XG4gIHJlbmRlclBob3RvcyhwaG90b3MpO1xuICBmaWx0ZXIuaW5pdGlhbGl6ZShwaG90b3MpO1xufTtcblxuLyoqXG4gKiDQl9Cw0LrRgNGL0LLQsNC10YIg0L/QvtC/LdCw0L8g0YEg0YHQvtC+0LHRidC10L3QuNC10Lwg0L7QsSDQvtGI0LjQsdC60LVcbiAqXG4gKi9cbmNvbnN0IG9uRXJyb3JQb3B1cENsb3NlQ2xpY2sgPSAoKSA9PiB7XG4gIGVycm9yUG9wdXAuY2xhc3NMaXN0LmFkZChgaGlkZGVuYCk7XG4gIGVycm9yUG9wdXBDbG9zZS5yZW1vdmVFdmVudExpc3RlbmVyKGBjbGlja2AsIG9uRXJyb3JQb3B1cENsb3NlQ2xpY2spO1xufTtcblxuLyoqXG4gKiDQn9C+0LrQsNC30YvQstCw0LXRgiDQv9C+0L8t0LDQvyDRgSDRgdC+0L7QsdGJ0LXQvdC40LXQvCDQvtCxINC+0YjQuNCx0LrQtVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKi9cbmNvbnN0IG9uRXJyb3IgPSAobWVzc2FnZSkgPT4ge1xuICBpZiAoZXJyb3JQb3B1cC5jbGFzc0xpc3QuY29udGFpbnMoYGhpZGRlbmApKSB7XG4gICAgZXJyb3JQb3B1cC5jbGFzc0xpc3QucmVtb3ZlKGBoaWRkZW5gKTtcbiAgICBlcnJvclBvcHVwTWVzc2FnZS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gICAgc2V0VGltZW91dChvbkVycm9yUG9wdXBDbG9zZUNsaWNrLCBQT1BBUF9FUlJPUl9JTlRFUlZBTCk7XG4gICAgZXJyb3JQb3B1cENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgb25FcnJvclBvcHVwQ2xvc2VDbGljayk7XG4gIH1cbn07XG5cbi8qKlxuICog0JjQvdC40YbQuNCw0LvQuNC30LjRgNGD0LXRgiDRgNCw0LHQvtGC0YMg0YHQviDRgdGC0YDQsNC90LjRhtC10Lkg0YHQsNC50YLQsFxuICpcbiAqL1xuY29uc3QgaW5pdGlhbGl6ZSA9ICgpID0+IHtcbiAgLy8g0JfQsNCz0YDRg9C20LDQtdGCINGBINGB0LXRgNCy0LXRgNCwINGE0L7RgtC+0LPRgNCw0YTQuNC4INC4INC+0YLQvtCx0YDQsNC20LDQtdGCINC40YUuXG4gIC8vINCSINGB0LvRg9GH0LDQtSDQvtGI0LjQsdC60Lgg0LfQsNCz0YDRg9C30LrQuCDQtNCw0L3QvdGL0YUg0L/QvtC60LDQt9GL0LLQsNC10YIg0L/QvtC/LdCw0L8g0YEg0L7Qv9C40YHQsNC90LjQtdC8INC+0YjQuNCx0LrQuFxuICBiYWNrZW5kLmxvYWQob25TdWNjZXNzLCBvbkVycm9yKTtcblxuICAvLyDQntGC0LrRgNGL0LLQsNC10YIg0L/QsNC90LXQu9GMINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8g0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0L/RgNC4XG4gIC8vINC90LDQttCw0YLQuNC4INC90LAg0LrQvdC+0L/QutGDIHVwbG9hZEJ1dHRvblxuICB1cGxvYWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihgY2hhbmdlYCwgZm9ybS5pbml0aWFsaXplKTtcbn07XG5cbmluaXRpYWxpemUoKTtcbiJdfQ==