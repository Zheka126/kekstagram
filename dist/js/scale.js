"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var editPanel = document.querySelector(".img-upload__overlay");
var scalePanel = editPanel.querySelector(".scale");
var effectLevel = scalePanel.querySelector(".scale__value");
var scalePin = scalePanel.querySelector(".scale__pin");
var scaleLevel = scalePanel.querySelector(".scale__level");
var scaleLine = scalePanel.querySelector(".scale__line");
var EFFECT_MAX_LEVEL = 100;
var pin = void 0;

/**
* Скрывает ползунок scale и удаляет обработчик событий
* с пина ползунка
*
*/
var hide = exports.hide = function hide() {
  scalePanel.classList.add("hidden");
  scalePin.removeEventListener("mousedown", onScalePinMouseDown);
};

/**
* Показывает ползунок scale и добавлляет обработчик событий
* для пина ползунка
*
*/
var show = exports.show = function show() {
  if (scalePanel.classList.contains("hidden")) {
    scalePanel.classList.remove("hidden");
    scalePin.addEventListener("mousedown", onScalePinMouseDown);
  }
};

/**
* Присваивает уровню эффекта effectLevel значение value;
* перемещает пин ползунка в соответствии с величиной value
*
* @param {number} value Значение от 0 до 100
*/
var setPinPosition = exports.setPinPosition = function setPinPosition(value) {
  effectLevel.value = Math.round(value);
  scalePin.style.left = value + "%";
  scaleLevel.style.width = value + "%";
};

/**
* Присваивает переменной pin значения примененного эффекта
* и функции, используюшейся при перемещении пина
*
* @param {string} effect
* @param {function} action
*/
var setPinAction = exports.setPinAction = function setPinAction(effect, action) {
  pin = {
    effect: effect,
    action: action
  };
};

/**
 * Перемещает пин позунка и в зависимости от его положения
 * применяет эффекты к изображению
 *
 * @param {Event} evt
 */
var onScalePinMouseDown = function onScalePinMouseDown(evt) {
  evt.preventDefault();
  var scaleWidth = scaleLine.offsetWidth;

  var startCoord = evt.clientX;

  scalePin.style.cursor = "none";
  document.documentElement.style.cursor = "none";

  var onMouseMove = function onMouseMove(moveEvt) {
    moveEvt.preventDefault();

    var shift = startCoord - moveEvt.clientX;
    startCoord = moveEvt.clientX;

    var currentCoord = scalePin.offsetLeft - shift;

    if (currentCoord < 0) {
      currentCoord = 0;
    } else if (currentCoord > scaleWidth) {
      currentCoord = scaleWidth;
    }

    var currentValue = currentCoord * EFFECT_MAX_LEVEL / scaleWidth;

    setPinPosition(currentValue);
    pin.action(pin.effect);
  };

  var onMouseUp = function onMouseUp(upEvt) {
    upEvt.preventDefault();

    scalePin.style.cursor = "move";
    document.documentElement.style.cursor = "auto";

    document.removeEventListener("mousemove", onMouseMove);
    document.removeEventListener("mouseup", onMouseUp);
  };

  document.addEventListener("mousemove", onMouseMove);
  document.addEventListener("mouseup", onMouseUp);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2pzL3NjYWxlLmpzIl0sIm5hbWVzIjpbImVkaXRQYW5lbCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInNjYWxlUGFuZWwiLCJlZmZlY3RMZXZlbCIsInNjYWxlUGluIiwic2NhbGVMZXZlbCIsInNjYWxlTGluZSIsIkVGRkVDVF9NQVhfTEVWRUwiLCJwaW4iLCJoaWRlIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9uU2NhbGVQaW5Nb3VzZURvd24iLCJzaG93IiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwic2V0UGluUG9zaXRpb24iLCJ2YWx1ZSIsIk1hdGgiLCJyb3VuZCIsInN0eWxlIiwibGVmdCIsIndpZHRoIiwic2V0UGluQWN0aW9uIiwiZWZmZWN0IiwiYWN0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJzY2FsZVdpZHRoIiwib2Zmc2V0V2lkdGgiLCJzdGFydENvb3JkIiwiY2xpZW50WCIsImN1cnNvciIsImRvY3VtZW50RWxlbWVudCIsIm9uTW91c2VNb3ZlIiwibW92ZUV2dCIsInNoaWZ0IiwiY3VycmVudENvb3JkIiwib2Zmc2V0TGVmdCIsImN1cnJlbnRWYWx1ZSIsIm9uTW91c2VVcCIsInVwRXZ0Il0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQU1BLFlBQVlDLFNBQVNDLGFBQVQsd0JBQWxCO0FBQ0EsSUFBTUMsYUFBYUgsVUFBVUUsYUFBVixVQUFuQjtBQUNBLElBQU1FLGNBQWNELFdBQVdELGFBQVgsaUJBQXBCO0FBQ0EsSUFBTUcsV0FBV0YsV0FBV0QsYUFBWCxlQUFqQjtBQUNBLElBQU1JLGFBQWFILFdBQVdELGFBQVgsaUJBQW5CO0FBQ0EsSUFBTUssWUFBWUosV0FBV0QsYUFBWCxnQkFBbEI7QUFDQSxJQUFNTSxtQkFBbUIsR0FBekI7QUFDQSxJQUFJQyxZQUFKOztBQUVPOzs7OztBQUtQLElBQU1DLHNCQUFPLFNBQVBBLElBQU8sR0FBTTtBQUNqQlAsYUFBV1EsU0FBWCxDQUFxQkMsR0FBckI7QUFDQVAsV0FBU1EsbUJBQVQsY0FBMENDLG1CQUExQztBQUNELENBSEQ7O0FBS087Ozs7O0FBS1AsSUFBTUMsc0JBQU8sU0FBUEEsSUFBTyxHQUFNO0FBQ2pCLE1BQUlaLFdBQVdRLFNBQVgsQ0FBcUJLLFFBQXJCLFVBQUosRUFBNkM7QUFDM0NiLGVBQVdRLFNBQVgsQ0FBcUJNLE1BQXJCO0FBQ0FaLGFBQVNhLGdCQUFULGNBQXVDSixtQkFBdkM7QUFDRDtBQUNGLENBTEQ7O0FBT087Ozs7OztBQU1QLElBQU1LLDBDQUFpQixTQUFqQkEsY0FBaUIsQ0FBQ0MsS0FBRCxFQUFXO0FBQ2hDaEIsY0FBWWdCLEtBQVosR0FBb0JDLEtBQUtDLEtBQUwsQ0FBV0YsS0FBWCxDQUFwQjtBQUNBZixXQUFTa0IsS0FBVCxDQUFlQyxJQUFmLEdBQXlCSixLQUF6QjtBQUNBZCxhQUFXaUIsS0FBWCxDQUFpQkUsS0FBakIsR0FBNEJMLEtBQTVCO0FBQ0QsQ0FKRDs7QUFNTzs7Ozs7OztBQU9QLElBQU1NLHNDQUFlLFNBQWZBLFlBQWUsQ0FBQ0MsTUFBRCxFQUFTQyxNQUFULEVBQW9CO0FBQ3ZDbkIsUUFBTTtBQUNKa0Isa0JBREk7QUFFSkM7QUFGSSxHQUFOO0FBSUQsQ0FMRDs7QUFPQTs7Ozs7O0FBTUEsSUFBTWQsc0JBQXNCLFNBQXRCQSxtQkFBc0IsQ0FBQ2UsR0FBRCxFQUFTO0FBQ25DQSxNQUFJQyxjQUFKO0FBQ0EsTUFBTUMsYUFBYXhCLFVBQVV5QixXQUE3Qjs7QUFFQSxNQUFJQyxhQUFhSixJQUFJSyxPQUFyQjs7QUFFQTdCLFdBQVNrQixLQUFULENBQWVZLE1BQWY7QUFDQWxDLFdBQVNtQyxlQUFULENBQXlCYixLQUF6QixDQUErQlksTUFBL0I7O0FBRUEsTUFBTUUsY0FBYyxTQUFkQSxXQUFjLENBQUNDLE9BQUQsRUFBYTtBQUMvQkEsWUFBUVIsY0FBUjs7QUFFQSxRQUFNUyxRQUFRTixhQUFhSyxRQUFRSixPQUFuQztBQUNBRCxpQkFBYUssUUFBUUosT0FBckI7O0FBRUEsUUFBSU0sZUFBZW5DLFNBQVNvQyxVQUFULEdBQXNCRixLQUF6Qzs7QUFFQSxRQUFJQyxlQUFlLENBQW5CLEVBQXNCO0FBQ3BCQSxxQkFBZSxDQUFmO0FBQ0QsS0FGRCxNQUVPLElBQUlBLGVBQWVULFVBQW5CLEVBQStCO0FBQ3BDUyxxQkFBZVQsVUFBZjtBQUNEOztBQUVELFFBQU1XLGVBQWVGLGVBQWVoQyxnQkFBZixHQUFrQ3VCLFVBQXZEOztBQUVBWixtQkFBZXVCLFlBQWY7QUFDQWpDLFFBQUltQixNQUFKLENBQVduQixJQUFJa0IsTUFBZjtBQUNELEdBbEJEOztBQW9CQSxNQUFNZ0IsWUFBWSxTQUFaQSxTQUFZLENBQUNDLEtBQUQsRUFBVztBQUMzQkEsVUFBTWQsY0FBTjs7QUFFQXpCLGFBQVNrQixLQUFULENBQWVZLE1BQWY7QUFDQWxDLGFBQVNtQyxlQUFULENBQXlCYixLQUF6QixDQUErQlksTUFBL0I7O0FBRUFsQyxhQUFTWSxtQkFBVCxjQUEwQ3dCLFdBQTFDO0FBQ0FwQyxhQUFTWSxtQkFBVCxZQUF3QzhCLFNBQXhDO0FBQ0QsR0FSRDs7QUFVQTFDLFdBQVNpQixnQkFBVCxjQUF1Q21CLFdBQXZDO0FBQ0FwQyxXQUFTaUIsZ0JBQVQsWUFBcUN5QixTQUFyQztBQUNELENBekNEIiwiZmlsZSI6InNjYWxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZWRpdFBhbmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmltZy11cGxvYWRfX292ZXJsYXlgKTtcbmNvbnN0IHNjYWxlUGFuZWwgPSBlZGl0UGFuZWwucXVlcnlTZWxlY3RvcihgLnNjYWxlYCk7XG5jb25zdCBlZmZlY3RMZXZlbCA9IHNjYWxlUGFuZWwucXVlcnlTZWxlY3RvcihgLnNjYWxlX192YWx1ZWApO1xuY29uc3Qgc2NhbGVQaW4gPSBzY2FsZVBhbmVsLnF1ZXJ5U2VsZWN0b3IoYC5zY2FsZV9fcGluYCk7XG5jb25zdCBzY2FsZUxldmVsID0gc2NhbGVQYW5lbC5xdWVyeVNlbGVjdG9yKGAuc2NhbGVfX2xldmVsYCk7XG5jb25zdCBzY2FsZUxpbmUgPSBzY2FsZVBhbmVsLnF1ZXJ5U2VsZWN0b3IoYC5zY2FsZV9fbGluZWApO1xuY29uc3QgRUZGRUNUX01BWF9MRVZFTCA9IDEwMDtcbmxldCBwaW47XG5cbmV4cG9ydCAvKipcbiAqINCh0LrRgNGL0LLQsNC10YIg0L/QvtC70LfRg9C90L7QuiBzY2FsZSDQuCDRg9C00LDQu9GP0LXRgiDQvtCx0YDQsNCx0L7RgtGH0LjQuiDRgdC+0LHRi9GC0LjQuVxuICog0YEg0L/QuNC90LAg0L/QvtC70LfRg9C90LrQsFxuICpcbiAqL1xuY29uc3QgaGlkZSA9ICgpID0+IHtcbiAgc2NhbGVQYW5lbC5jbGFzc0xpc3QuYWRkKGBoaWRkZW5gKTtcbiAgc2NhbGVQaW4ucmVtb3ZlRXZlbnRMaXN0ZW5lcihgbW91c2Vkb3duYCwgb25TY2FsZVBpbk1vdXNlRG93bik7XG59O1xuXG5leHBvcnQgLyoqXG4gKiDQn9C+0LrQsNC30YvQstCw0LXRgiDQv9C+0LvQt9GD0L3QvtC6IHNjYWxlINC4INC00L7QsdCw0LLQu9C70Y/QtdGCINC+0LHRgNCw0LHQvtGC0YfQuNC6INGB0L7QsdGL0YLQuNC5XG4gKiDQtNC70Y8g0L/QuNC90LAg0L/QvtC70LfRg9C90LrQsFxuICpcbiAqL1xuY29uc3Qgc2hvdyA9ICgpID0+IHtcbiAgaWYgKHNjYWxlUGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGBoaWRkZW5gKSkge1xuICAgIHNjYWxlUGFuZWwuY2xhc3NMaXN0LnJlbW92ZShgaGlkZGVuYCk7XG4gICAgc2NhbGVQaW4uYWRkRXZlbnRMaXN0ZW5lcihgbW91c2Vkb3duYCwgb25TY2FsZVBpbk1vdXNlRG93bik7XG4gIH1cbn07XG5cbmV4cG9ydCAvKipcbiAqINCf0YDQuNGB0LLQsNC40LLQsNC10YIg0YPRgNC+0LLQvdGOINGN0YTRhNC10LrRgtCwIGVmZmVjdExldmVsINC30L3QsNGH0LXQvdC40LUgdmFsdWU7XG4gKiDQv9C10YDQtdC80LXRidCw0LXRgiDQv9C40L0g0L/QvtC70LfRg9C90LrQsCDQsiDRgdC+0L7RgtCy0LXRgtGB0YLQstC40Lgg0YEg0LLQtdC70LjRh9C40L3QvtC5IHZhbHVlXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlINCX0L3QsNGH0LXQvdC40LUg0L7RgiAwINC00L4gMTAwXG4gKi9cbmNvbnN0IHNldFBpblBvc2l0aW9uID0gKHZhbHVlKSA9PiB7XG4gIGVmZmVjdExldmVsLnZhbHVlID0gTWF0aC5yb3VuZCh2YWx1ZSk7XG4gIHNjYWxlUGluLnN0eWxlLmxlZnQgPSBgJHt2YWx1ZX0lYDtcbiAgc2NhbGVMZXZlbC5zdHlsZS53aWR0aCA9IGAke3ZhbHVlfSVgO1xufTtcblxuZXhwb3J0IC8qKlxuICog0J/RgNC40YHQstCw0LjQstCw0LXRgiDQv9C10YDQtdC80LXQvdC90L7QuSBwaW4g0LfQvdCw0YfQtdC90LjRjyDQv9GA0LjQvNC10L3QtdC90L3QvtCz0L4g0Y3RhNGE0LXQutGC0LBcbiAqINC4INGE0YPQvdC60YbQuNC4LCDQuNGB0L/QvtC70YzQt9GD0Y7RiNC10LnRgdGPINC/0YDQuCDQv9C10YDQtdC80LXRidC10L3QuNC4INC/0LjQvdCwXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGVmZmVjdFxuICogQHBhcmFtIHtmdW5jdGlvbn0gYWN0aW9uXG4gKi9cbmNvbnN0IHNldFBpbkFjdGlvbiA9IChlZmZlY3QsIGFjdGlvbikgPT4ge1xuICBwaW4gPSB7XG4gICAgZWZmZWN0LFxuICAgIGFjdGlvblxuICB9O1xufTtcblxuLyoqXG4gKiDQn9C10YDQtdC80LXRidCw0LXRgiDQv9C40L0g0L/QvtC30YPQvdC60LAg0Lgg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINC10LPQviDQv9C+0LvQvtC20LXQvdC40Y9cbiAqINC/0YDQuNC80LXQvdGP0LXRgiDRjdGE0YTQtdC60YLRiyDQuiDQuNC30L7QsdGA0LDQttC10L3QuNGOXG4gKlxuICogQHBhcmFtIHtFdmVudH0gZXZ0XG4gKi9cbmNvbnN0IG9uU2NhbGVQaW5Nb3VzZURvd24gPSAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzY2FsZVdpZHRoID0gc2NhbGVMaW5lLm9mZnNldFdpZHRoO1xuXG4gIGxldCBzdGFydENvb3JkID0gZXZ0LmNsaWVudFg7XG5cbiAgc2NhbGVQaW4uc3R5bGUuY3Vyc29yID0gYG5vbmVgO1xuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuY3Vyc29yID0gYG5vbmVgO1xuXG4gIGNvbnN0IG9uTW91c2VNb3ZlID0gKG1vdmVFdnQpID0+IHtcbiAgICBtb3ZlRXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBzaGlmdCA9IHN0YXJ0Q29vcmQgLSBtb3ZlRXZ0LmNsaWVudFg7XG4gICAgc3RhcnRDb29yZCA9IG1vdmVFdnQuY2xpZW50WDtcblxuICAgIGxldCBjdXJyZW50Q29vcmQgPSBzY2FsZVBpbi5vZmZzZXRMZWZ0IC0gc2hpZnQ7XG5cbiAgICBpZiAoY3VycmVudENvb3JkIDwgMCkge1xuICAgICAgY3VycmVudENvb3JkID0gMDtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnRDb29yZCA+IHNjYWxlV2lkdGgpIHtcbiAgICAgIGN1cnJlbnRDb29yZCA9IHNjYWxlV2lkdGg7XG4gICAgfVxuXG4gICAgY29uc3QgY3VycmVudFZhbHVlID0gY3VycmVudENvb3JkICogRUZGRUNUX01BWF9MRVZFTCAvIHNjYWxlV2lkdGg7XG5cbiAgICBzZXRQaW5Qb3NpdGlvbihjdXJyZW50VmFsdWUpO1xuICAgIHBpbi5hY3Rpb24ocGluLmVmZmVjdCk7XG4gIH07XG5cbiAgY29uc3Qgb25Nb3VzZVVwID0gKHVwRXZ0KSA9PiB7XG4gICAgdXBFdnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIHNjYWxlUGluLnN0eWxlLmN1cnNvciA9IGBtb3ZlYDtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuY3Vyc29yID0gYGF1dG9gO1xuXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihgbW91c2Vtb3ZlYCwgb25Nb3VzZU1vdmUpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYG1vdXNldXBgLCBvbk1vdXNlVXApO1xuICB9O1xuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoYG1vdXNlbW92ZWAsIG9uTW91c2VNb3ZlKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihgbW91c2V1cGAsIG9uTW91c2VVcCk7XG59O1xuIl19