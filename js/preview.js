'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.open = undefined;

var _util = require('./util');

var util = _interopRequireWildcard(_util);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

var bodyElement = document.querySelector('body');
var preview = document.querySelector('.big-picture');
var previewClose = preview.querySelector('.cancel');
var previewImage = preview.querySelector('.big-picture__img').querySelector('img');
var previewCommentsCount = preview.querySelector('.social__comment-count');
var previewCommentsLoad = preview.querySelector('.social__comment-loadmore');
var previewCaption = preview.querySelector('.social__caption');
var previewLikes = preview.querySelector('.likes-count');
var previewCommentsBlock = preview.querySelector('.social__comments');

/**
 * Закрывает поп-ап с полноэкранной версией фотографии
 *
 */
var onPreviewCloseClick = function onPreviewCloseClick() {
  bodyElement.classList.remove('modal-open');
  preview.classList.add('hidden');
  previewClose.removeEventListener('click', onPreviewCloseClick);
  document.removeEventListener('keydown', onPreviewEscPress);
};

/**
 * Закрывает поп-ап с полноэкранной версией фотографии при нажатии на ESC
 *
 * @param {Event} evt
 */
var onPreviewEscPress = function onPreviewEscPress(evt) {
  util.runOnEscPress(evt, onPreviewCloseClick);
};

/**
 * Возвращает шаблон DOM-элемента для комментария comment
 *
 * @param {string} comment
 * @return {string}
 */
var createCommentTemplate = function createCommentTemplate(comment) {
  return '<li class="social__comment social__comment--text">\n  <img class="social__picture" src="img/avatar-' + util.getRandomNumber(1, 6) + '.svg"\n  alt="\u0410\u0432\u0430\u0442\u0430\u0440 \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0442\u043E\u0440\u0430 \u0444\u043E\u0442\u043E\u0433\u0440\u0430\u0444\u0438\u0438" width="35" height="35">' + comment + '</li>';
};

/**
 * Наполняет DOM-элемент `Фотография в полноэкранном режиме` данными объекта photoData
 *
 * @param {Object} photoData
 */
var fillPreview = function fillPreview(photoData) {
  previewCommentsCount.classList.add('visually-hidden');
  previewCommentsLoad.classList.add('visually-hidden');

  previewImage.src = photoData.url;
  previewCaption.textContent = photoData.description;
  previewLikes.textContent = photoData.likes;

  util.removeChildren(previewCommentsBlock);

  var commentsBlockElements = photoData.comments.map(function (value) {
    return createCommentTemplate(value);
  });

  previewCommentsBlock.insertAdjacentHTML('afterbegin', commentsBlockElements.join(''));
};

/**
* Открывает поп-ап с полноэкранной версией фотографии
*
* @param {Object} photoData
*/
var open = exports.open = function open(photoData) {
  bodyElement.classList.add('modal-open');
  preview.classList.remove('hidden');
  previewClose.addEventListener('click', onPreviewCloseClick);
  document.addEventListener('keydown', onPreviewEscPress);
  fillPreview(photoData);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2pzL3ByZXZpZXcuanMiXSwibmFtZXMiOlsidXRpbCIsImJvZHlFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJldmlldyIsInByZXZpZXdDbG9zZSIsInByZXZpZXdJbWFnZSIsInByZXZpZXdDb21tZW50c0NvdW50IiwicHJldmlld0NvbW1lbnRzTG9hZCIsInByZXZpZXdDYXB0aW9uIiwicHJldmlld0xpa2VzIiwicHJldmlld0NvbW1lbnRzQmxvY2siLCJvblByZXZpZXdDbG9zZUNsaWNrIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9uUHJldmlld0VzY1ByZXNzIiwiZXZ0IiwicnVuT25Fc2NQcmVzcyIsImNyZWF0ZUNvbW1lbnRUZW1wbGF0ZSIsImNvbW1lbnQiLCJnZXRSYW5kb21OdW1iZXIiLCJmaWxsUHJldmlldyIsInBob3RvRGF0YSIsInNyYyIsInVybCIsInRleHRDb250ZW50IiwiZGVzY3JpcHRpb24iLCJsaWtlcyIsInJlbW92ZUNoaWxkcmVuIiwiY29tbWVudHNCbG9ja0VsZW1lbnRzIiwiY29tbWVudHMiLCJtYXAiLCJ2YWx1ZSIsImluc2VydEFkamFjZW50SFRNTCIsImpvaW4iLCJvcGVuIiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztJQUFZQSxJOzs7O0FBRVosSUFBTUMsY0FBY0MsU0FBU0MsYUFBVCxRQUFwQjtBQUNBLElBQU1DLFVBQVVGLFNBQVNDLGFBQVQsZ0JBQWhCO0FBQ0EsSUFBTUUsZUFBZUQsUUFBUUQsYUFBUixXQUFyQjtBQUNBLElBQU1HLGVBQWVGLFFBQVFELGFBQVIsc0JBQ2hCQSxhQURnQixPQUFyQjtBQUVBLElBQU1JLHVCQUF1QkgsUUFBUUQsYUFBUiwwQkFBN0I7QUFDQSxJQUFNSyxzQkFBc0JKLFFBQVFELGFBQVIsNkJBQTVCO0FBQ0EsSUFBTU0saUJBQWlCTCxRQUFRRCxhQUFSLG9CQUF2QjtBQUNBLElBQU1PLGVBQWVOLFFBQVFELGFBQVIsZ0JBQXJCO0FBQ0EsSUFBTVEsdUJBQXVCUCxRQUFRRCxhQUFSLHFCQUE3Qjs7QUFFQTs7OztBQUlBLElBQU1TLHNCQUFzQixTQUF0QkEsbUJBQXNCLEdBQU07QUFDaENYLGNBQVlZLFNBQVosQ0FBc0JDLE1BQXRCO0FBQ0FWLFVBQVFTLFNBQVIsQ0FBa0JFLEdBQWxCO0FBQ0FWLGVBQWFXLG1CQUFiLFVBQTBDSixtQkFBMUM7QUFDQVYsV0FBU2MsbUJBQVQsWUFBd0NDLGlCQUF4QztBQUNELENBTEQ7O0FBT0E7Ozs7O0FBS0EsSUFBTUEsb0JBQW9CLFNBQXBCQSxpQkFBb0IsQ0FBQ0MsR0FBRCxFQUFTO0FBQ2pDbEIsT0FBS21CLGFBQUwsQ0FBbUJELEdBQW5CLEVBQXdCTixtQkFBeEI7QUFDRCxDQUZEOztBQUlBOzs7Ozs7QUFNQSxJQUFNUSx3QkFBd0IsU0FBeEJBLHFCQUF3QixDQUFDQyxPQUFEO0FBQUEsaUhBRW1CckIsS0FBS3NCLGVBQUwsQ0FBcUIsQ0FBckIsRUFBd0IsQ0FBeEIsQ0FGbkIseU5BR2tDRCxPQUhsQztBQUFBLENBQTlCOztBQUtBOzs7OztBQUtBLElBQU1FLGNBQWMsU0FBZEEsV0FBYyxDQUFDQyxTQUFELEVBQWU7QUFDakNqQix1QkFBcUJNLFNBQXJCLENBQStCRSxHQUEvQjtBQUNBUCxzQkFBb0JLLFNBQXBCLENBQThCRSxHQUE5Qjs7QUFFQVQsZUFBYW1CLEdBQWIsR0FBbUJELFVBQVVFLEdBQTdCO0FBQ0FqQixpQkFBZWtCLFdBQWYsR0FBNkJILFVBQVVJLFdBQXZDO0FBQ0FsQixlQUFhaUIsV0FBYixHQUEyQkgsVUFBVUssS0FBckM7O0FBRUE3QixPQUFLOEIsY0FBTCxDQUFvQm5CLG9CQUFwQjs7QUFFQSxNQUFNb0Isd0JBQXdCUCxVQUFVUSxRQUFWLENBQW1CQyxHQUFuQixDQUF1QixVQUFDQyxLQUFEO0FBQUEsV0FBV2Qsc0JBQXNCYyxLQUF0QixDQUFYO0FBQUEsR0FBdkIsQ0FBOUI7O0FBRUF2Qix1QkFBcUJ3QixrQkFBckIsZUFBc0RKLHNCQUFzQkssSUFBdEIsSUFBdEQ7QUFDRCxDQWJEOztBQWVPOzs7OztBQUtQLElBQU1DLHNCQUFPLFNBQVBBLElBQU8sQ0FBQ2IsU0FBRCxFQUFlO0FBQzFCdkIsY0FBWVksU0FBWixDQUFzQkUsR0FBdEI7QUFDQVgsVUFBUVMsU0FBUixDQUFrQkMsTUFBbEI7QUFDQVQsZUFBYWlDLGdCQUFiLFVBQXVDMUIsbUJBQXZDO0FBQ0FWLFdBQVNvQyxnQkFBVCxZQUFxQ3JCLGlCQUFyQztBQUNBTSxjQUFZQyxTQUFaO0FBQ0QsQ0FORCIsImZpbGUiOiJwcmV2aWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgdXRpbCBmcm9tICcuL3V0aWwnO1xuXG5jb25zdCBib2R5RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGJvZHlgKTtcbmNvbnN0IHByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYmlnLXBpY3R1cmVgKTtcbmNvbnN0IHByZXZpZXdDbG9zZSA9IHByZXZpZXcucXVlcnlTZWxlY3RvcihgLmNhbmNlbGApO1xuY29uc3QgcHJldmlld0ltYWdlID0gcHJldmlldy5xdWVyeVNlbGVjdG9yKGAuYmlnLXBpY3R1cmVfX2ltZ2ApXG4gICAgLnF1ZXJ5U2VsZWN0b3IoYGltZ2ApO1xuY29uc3QgcHJldmlld0NvbW1lbnRzQ291bnQgPSBwcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoYC5zb2NpYWxfX2NvbW1lbnQtY291bnRgKTtcbmNvbnN0IHByZXZpZXdDb21tZW50c0xvYWQgPSBwcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoYC5zb2NpYWxfX2NvbW1lbnQtbG9hZG1vcmVgKTtcbmNvbnN0IHByZXZpZXdDYXB0aW9uID0gcHJldmlldy5xdWVyeVNlbGVjdG9yKGAuc29jaWFsX19jYXB0aW9uYCk7XG5jb25zdCBwcmV2aWV3TGlrZXMgPSBwcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoYC5saWtlcy1jb3VudGApO1xuY29uc3QgcHJldmlld0NvbW1lbnRzQmxvY2sgPSBwcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoYC5zb2NpYWxfX2NvbW1lbnRzYCk7XG5cbi8qKlxuICog0JfQsNC60YDRi9Cy0LDQtdGCINC/0L7Qvy3QsNC/INGBINC/0L7Qu9C90L7RjdC60YDQsNC90L3QvtC5INCy0LXRgNGB0LjQtdC5INGE0L7RgtC+0LPRgNCw0YTQuNC4XG4gKlxuICovXG5jb25zdCBvblByZXZpZXdDbG9zZUNsaWNrID0gKCkgPT4ge1xuICBib2R5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGBtb2RhbC1vcGVuYCk7XG4gIHByZXZpZXcuY2xhc3NMaXN0LmFkZChgaGlkZGVuYCk7XG4gIHByZXZpZXdDbG9zZS5yZW1vdmVFdmVudExpc3RlbmVyKGBjbGlja2AsIG9uUHJldmlld0Nsb3NlQ2xpY2spO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGBrZXlkb3duYCwgb25QcmV2aWV3RXNjUHJlc3MpO1xufTtcblxuLyoqXG4gKiDQl9Cw0LrRgNGL0LLQsNC10YIg0L/QvtC/LdCw0L8g0YEg0L/QvtC70L3QvtGN0LrRgNCw0L3QvdC+0Lkg0LLQtdGA0YHQuNC10Lkg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0L/RgNC4INC90LDQttCw0YLQuNC4INC90LAgRVNDXG4gKlxuICogQHBhcmFtIHtFdmVudH0gZXZ0XG4gKi9cbmNvbnN0IG9uUHJldmlld0VzY1ByZXNzID0gKGV2dCkgPT4ge1xuICB1dGlsLnJ1bk9uRXNjUHJlc3MoZXZ0LCBvblByZXZpZXdDbG9zZUNsaWNrKTtcbn07XG5cbi8qKlxuICog0JLQvtC30LLRgNCw0YnQsNC10YIg0YjQsNCx0LvQvtC9IERPTS3RjdC70LXQvNC10L3RgtCwINC00LvRjyDQutC+0LzQvNC10L3RgtCw0YDQuNGPIGNvbW1lbnRcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbWVudFxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5jb25zdCBjcmVhdGVDb21tZW50VGVtcGxhdGUgPSAoY29tbWVudCkgPT5cbiAgYDxsaSBjbGFzcz1cInNvY2lhbF9fY29tbWVudCBzb2NpYWxfX2NvbW1lbnQtLXRleHRcIj5cbiAgPGltZyBjbGFzcz1cInNvY2lhbF9fcGljdHVyZVwiIHNyYz1cImltZy9hdmF0YXItJHt1dGlsLmdldFJhbmRvbU51bWJlcigxLCA2KX0uc3ZnXCJcbiAgYWx0PVwi0JDQstCw0YLQsNGAINC60L7QvNC80LXQvdGC0LDRgtC+0YDQsCDRhNC+0YLQvtCz0YDQsNGE0LjQuFwiIHdpZHRoPVwiMzVcIiBoZWlnaHQ9XCIzNVwiPiR7Y29tbWVudH08L2xpPmA7XG5cbi8qKlxuICog0J3QsNC/0L7Qu9C90Y/QtdGCIERPTS3RjdC70LXQvNC10L3RgiBg0KTQvtGC0L7Qs9GA0LDRhNC40Y8g0LIg0L/QvtC70L3QvtGN0LrRgNCw0L3QvdC+0Lwg0YDQtdC20LjQvNC1YCDQtNCw0L3QvdGL0LzQuCDQvtCx0YrQtdC60YLQsCBwaG90b0RhdGFcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGhvdG9EYXRhXG4gKi9cbmNvbnN0IGZpbGxQcmV2aWV3ID0gKHBob3RvRGF0YSkgPT4ge1xuICBwcmV2aWV3Q29tbWVudHNDb3VudC5jbGFzc0xpc3QuYWRkKGB2aXN1YWxseS1oaWRkZW5gKTtcbiAgcHJldmlld0NvbW1lbnRzTG9hZC5jbGFzc0xpc3QuYWRkKGB2aXN1YWxseS1oaWRkZW5gKTtcblxuICBwcmV2aWV3SW1hZ2Uuc3JjID0gcGhvdG9EYXRhLnVybDtcbiAgcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBwaG90b0RhdGEuZGVzY3JpcHRpb247XG4gIHByZXZpZXdMaWtlcy50ZXh0Q29udGVudCA9IHBob3RvRGF0YS5saWtlcztcblxuICB1dGlsLnJlbW92ZUNoaWxkcmVuKHByZXZpZXdDb21tZW50c0Jsb2NrKTtcblxuICBjb25zdCBjb21tZW50c0Jsb2NrRWxlbWVudHMgPSBwaG90b0RhdGEuY29tbWVudHMubWFwKCh2YWx1ZSkgPT4gY3JlYXRlQ29tbWVudFRlbXBsYXRlKHZhbHVlKSk7XG5cbiAgcHJldmlld0NvbW1lbnRzQmxvY2suaW5zZXJ0QWRqYWNlbnRIVE1MKGBhZnRlcmJlZ2luYCwgY29tbWVudHNCbG9ja0VsZW1lbnRzLmpvaW4oYGApKTtcbn07XG5cbmV4cG9ydCAvKipcbiAqINCe0YLQutGA0YvQstCw0LXRgiDQv9C+0L8t0LDQvyDRgSDQv9C+0LvQvdC+0Y3QutGA0LDQvdC90L7QuSDQstC10YDRgdC40LXQuSDRhNC+0YLQvtCz0YDQsNGE0LjQuFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwaG90b0RhdGFcbiAqL1xuY29uc3Qgb3BlbiA9IChwaG90b0RhdGEpID0+IHtcbiAgYm9keUVsZW1lbnQuY2xhc3NMaXN0LmFkZChgbW9kYWwtb3BlbmApO1xuICBwcmV2aWV3LmNsYXNzTGlzdC5yZW1vdmUoYGhpZGRlbmApO1xuICBwcmV2aWV3Q2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCBvblByZXZpZXdDbG9zZUNsaWNrKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihga2V5ZG93bmAsIG9uUHJldmlld0VzY1ByZXNzKTtcbiAgZmlsbFByZXZpZXcocGhvdG9EYXRhKTtcbn07XG4iXX0=